<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>setting</title>
    <script src="{{ url_for('static', filename='jquery.min.js') }}"></script>
    <link href="{{ url_for('static', filename='bootstrap/css/bootstrap.min.css') }}" rel="stylesheet">
    <script src="{{ url_for('static', filename='bootstrap/js/bootstrap.min.js') }}"></script>
    <script type="text/javascript">
        var $SCRIPT_ROOT = {{ request.script_root | tojson | safe }};
        $(function () {
            function submit_form2(e) {
                $.ajax({
                    url: $SCRIPT_ROOT + '/convert',
                    contentType: "application/json; charset=UTF-8",
                    dataType: 'json',
                    data: {
                        convert_url: $('input[id="convert_url"]').val(),
                        now: new Date().getTime()
                    },
                    error: function (xhr, err) {
                        $('#regex_result').text(err);
                    },
                    success: function (data, textStatus) {
                        $('#regex_result').text(data.regex);
                    }
                });
            };
            $('#convert').click(submit_form2);
        });
    </script>
    <!-- DataTables CSS -->
    <link rel="stylesheet" type="text/css" href="http://cdn.datatables.net/1.10.7/css/jquery.dataTables.css">

    <!-- DataTables -->
    <script type="text/javascript" charset="utf8"
            src="http://cdn.datatables.net/1.10.7/js/jquery.dataTables.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            var t = $('#detail-regex-tab').DataTable({
                "oLanguage": {
                    "sLengthMenu": "每页显示 _MENU_ 条记录",
                    "sZeroRecords": "没有找到",
                    "sInfo": "从 _START_ 到 _END_ /共 _TOTAL_ 条数据",
                    "sInfoEmpty": "没有数据",
                    "sInfoFiltered": "(从 _MAX_ 条数据中检索)",
                    "oPaginate": {
                        "sFirst": "首页",
                        "sPrevious": "前一页",
                        "sNext": "后一页",
                        "sLast": "尾页"
                    },
                    "sZeroRecords": "没有检索到数据",
                    "sProcessing": "<img src='./loading.gif' />"
                },
                "bFilter": false,
                "bLengthChange": true,
                "aLengthMenu": [5, 10, 50, "All"]
            });
            $('#addRow').on('click', function () {
                t.row.add([
                    'rule1',
                    '<<',
                    'url'
                ]).draw();
            });
        });
    </script>
</head>
<body>
<h1 align="center">列表页信息
    <small>请点击刷新按钮</small>
</h1>
<hr/>
<div id="message" class="alert alert-warning form-group center" style="width:80%; margin-left:10px">
    {% with messages = get_flashed_messages() %}
        {% if messages %}
            <ul class=flashes>
                {% for message in messages %}
                    <label>{{ message }}</label>
                {% endfor %}
            </ul>
        {% endif %}
    {% endwith %}
</div>

<form id="setting" method="POST" action="/get_show_list">
    <hr/>
    <div id="config" class="form-group center" style="width:80%; margin-left:50px">
        {{ myForm.start_urls.label }} &nbsp;{{ myForm.start_urls(size=30) }}&nbsp;&nbsp;&nbsp;
        {{ myForm.site_domain.label }} &nbsp;{{ myForm.site_domain(size=20) }}
    </div>
    <hr/>
    <div id="detail-regex" class="form-group" style="width:80%; margin-left:50px">
        <label for="name">详情页-正则表达式</label><br>
        <table id="detail-regex-tab">
            <thead>
            <tr>
                <th>选择</th>
                <th>正则表达式</th>
                <th>匹配数</th>
            </tr>
            </thead>
            <tbody>
            {% for row in myForm.regex_list %}
                <tr id="{{ loop.index }}">
                    <td>&nbsp;&nbsp;{{ row.select() }}</td>
                    <td>{{ row.regex(size=100) }}</td>
                    <td>{{ row.score(size=6) }}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
    <div id="submit" class="form-group" style="width:80%; margin-left:50px">
        <button type="button" class="btn">{{ myForm.submit() }}</button>
    </div>
</form>

</body>
</html>